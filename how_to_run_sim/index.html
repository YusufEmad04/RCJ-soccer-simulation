
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>How to run the simulation - RCJ Soccer Sim</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#running-the-simulator" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="RCJ Soccer Sim" class="md-header__button md-logo" aria-label="RCJ Soccer Sim" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            RCJ Soccer Sim
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              How to run the simulation
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="RCJ Soccer Sim" class="md-nav__button md-logo" aria-label="RCJ Soccer Sim" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    RCJ Soccer Sim
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../how_to_robot/" class="md-nav__link">
        How to program your robot
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../communication_between_robots/" class="md-nav__link">
        Inter-robot communication
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          How to run the simulation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        How to run the simulation
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#preliminaries" class="md-nav__link">
    Preliminaries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-soccer-sim-and-webots-in-automatic-mode" class="md-nav__link">
    Running Soccer Sim (and Webots) in Automatic Mode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-soccer-sim-in-docker" class="md-nav__link">
    Running Soccer Sim in Docker
  </a>
  
    <nav class="md-nav" aria-label="Running Soccer Sim in Docker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extracting-the-recorded-output" class="md-nav__link">
    Extracting the recorded output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-variables" class="md-nav__link">
    Environment variables
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#preliminaries" class="md-nav__link">
    Preliminaries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-soccer-sim-and-webots-in-automatic-mode" class="md-nav__link">
    Running Soccer Sim (and Webots) in Automatic Mode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-soccer-sim-in-docker" class="md-nav__link">
    Running Soccer Sim in Docker
  </a>
  
    <nav class="md-nav" aria-label="Running Soccer Sim in Docker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extracting-the-recorded-output" class="md-nav__link">
    Extracting the recorded output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-variables" class="md-nav__link">
    Environment variables
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="running-the-simulator">Running the simulator</h1>
<p><em>Note: This document is intended for the organizers of events in which the RCJ
Soccer Sim is to be used</em></p>
<p>This document outlines how the RoboCupJunior Soccer Sim can be used to simulate
a match in a "headless" way. In other words, it shows how you can go from
having the code for two teams and the RoboCupJunior Soccer Sim code to getting
an output in form of either an MPEG-4 video or a HTML site.</p>
<p><strong>Input</strong></p>
<ul>
<li>Source code for the yellow team</li>
<li>Source code for the blue team</li>
<li>RoboCupJunior Soccer Sim</li>
</ul>
<p><strong>Output</strong></p>
<ul>
<li>MPEG-4 video and/or HTML site</li>
<li>JSON file containing all the important events happened during the game</li>
</ul>
<h2 id="preliminaries">Preliminaries</h2>
<p>This guide makes a couple of assumptions:</p>
<ol>
<li>You use an UNIX-like environment (i.e. something like Linux or macOS)</li>
<li>You have Webots installed and cloned the <code>rcj-soccer-sim</code> repository locally
   (check the <a href="../getting_started/">Getting Started</a> guide on how to do so)</li>
</ol>
<h2 id="running-soccer-sim-and-webots-in-automatic-mode">Running Soccer Sim (and Webots) in Automatic Mode</h2>
<p>As Webots <a href="https://cyberbotics.com/doc/guide/starting-webots#command-line-arguments">docs</a>
state, it can also be started from a Terminal, or a command line prompt. The
most basic command would look as follows:</p>
<div class="highlight"><pre><span></span><code>webots --mode=fast worlds/soccer.wbt
</code></pre></div>
<p>This opens up Webots and automatically starts the game in the GUI. You can then
either pause the game, restart it or even manually setup the video/HTML export.</p>
<p>Soccer Sim's referee has the ability to automatically start the recording and
stop the execution when it finishes. To do so, the <code>RCJ_SIM_AUTO_MODE</code>
environment variable needs to be set (the value doesn't matter but we suggest
<code>True</code> or something of that sort). Furthermore, to make sure the game is
recorded, a recording format needs to be specified. This is done via the
<code>RCJ_SIM_REC_FORMATS</code> environment variable and all the options are documented
in the section below.</p>
<p>In summary, to automatically run the <code>world/soccer.wbt</code> world file (the Soccer
environment) and record the output in HTML format, the following command can be
used:</p>
<div class="highlight"><pre><span></span><code>RCJ_SIM_AUTO_MODE=True RCJ_SIM_REC_FORMATS=x3d webots --mode=fast worlds/soccer.wbt
</code></pre></div>
<h2 id="running-soccer-sim-in-docker">Running Soccer Sim in Docker</h2>
<p>To simplify the automatic running of games, Soccer Sim can also be executed
inside a Docker container. We generally recommend using the offical container
provided by Webots and mentioned in the <a href="https://cyberbotics.com/doc/guide/installation-procedure#installing-the-docker-image">official
guide</a>.</p>
<p>Assuming the <code>rcj-soccer-sim</code> repository is located in the current directory,
running Soccer Sim within docker is as simple as executing</p>
<div class="highlight"><pre><span></span><code>docker run \
    -v $(pwd)/rcj-soccer-sim:/rcj-soccer-sim \
    -e RCJ_SIM_AUTO_MODE=True \
    -e RCJ_SIM_REC_FORMATS=x3d \
    cyberbotics/webots:latest /rcj-soccer-sim/run-in-docker.sh /rcj-soccer-sim/worlds/soccer.wbt
</code></pre></div>
<p>Let us briefly discuss the respective lines. On the first one the <code>docker</code>
command starts the Docker container, on the second one, the <code>rcj-soccer-sim</code>
folder in the current directory is mapped to <code>/rcj-soccer-sim</code> in the
container, on the following two the <code>RCJ_SIM_AUTO_MODE</code> and
<code>RCJ_SIM_REC_FORMATS</code> environment variables are being set and on the last one
the <code>worlds/soccer.wbt</code> world from the <code>rcj-soccer-sim</code> repository is executed
in the Webex environment using the <code>run-in-docker.sh</code> script (also part of the
very same repository).</p>
<h3 id="extracting-the-recorded-output">Extracting the recorded output</h3>
<p>By default, the output (recording and reflog) of a match is saved in the
<code>reflog/</code> folder in <code>controllers/rcj_soccer_referee_supervisor/</code> of the
<code>rcj-soccer-sim</code> repository. This is relatively inconveniet when it comes to
running multiple games and getting data out of the Docker container and hence
the path can be changed using the <code>RCJ_SIM_OUTPUT_PATH</code> environment variable.</p>
<p>The command below redirects the output to the <code>/tmp/outputs</code> directory inside
the container and maps it to the <code>outputs/</code> directory in the current working
directory on the host:</p>
<div class="highlight"><pre><span></span><code>docker run \
    -v $(pwd)/rcj-soccer-sim:/rcj-soccer-sim \
    -v $(pwd)/outputs:/tmp/outputs  \
    -e RCJ_SIM_AUTO_MODE=True \
    -e RCJ_SIM_REC_FORMATS=x3d \
    -e RCJ_SIM_OUTPUT_PATH=/tmp/outputs/ \
    cyberbotics/webots:latest /rcj-soccer-sim/run-in-docker.sh /rcj-soccer-sim/worlds/soccer.wbt
</code></pre></div>
<h2 id="environment-variables">Environment variables</h2>
<p>The full list of environment variables supported by the Soccer Sim can be found
below:</p>
<ul>
<li><strong><code>RCJ_SIM_AUTO_MODE</code></strong>: If set (to any value), the simulation speed is set to
    fast, the recorders are started at the beginning and the application is
    automatically closed after the match is finished. Not set by default.</li>
<li><strong><code>RCJ_SIM_MATCH_TIME</code></strong>: Sets the number of seconds for which the match is to be
    played. Defaults to 600 (10 minutes).</li>
<li><strong><code>RCJ_SIM_REC_FORMATS</code></strong>: When set, the Soccer Sim starts a recording in these
    formats. The available options are <code>mp4</code> and <code>x3d</code>. Multiple options can be
    set as well, separated by a comma. Not set by default.</li>
<li><strong><code>RCJ_SIM_OUTPUT_PATH</code></strong>: The path where the reflog outputs as well as the
    recordings are to be saved. Defaults to the <code>reflog/</code> folder in
    <code>controllers/rcj_soccer_referee_supervisor/</code>.</li>
</ul>
<p>Internal team-related variables:</p>
<ul>
<li><strong><code>RCJ_SIM_TEAM_YELLOW_NAME</code></strong>: The name of the yellow team. Defaults to "The Yellows".</li>
<li><strong><code>RCJ_SIM_TEAM_Y_INITIAL_SCORE</code></strong>: The initial score of the yellow team. Defaults to 0.</li>
<li><strong><code>RCJ_SIM_TEAM_BLUE_NAME</code></strong>: The name of the blue team. Defaults to "The Blues".</li>
<li>
<p><strong><code>RCJ_SIM_TEAM_B_INITIAL_SCORE</code></strong>: The initial score of the blue team. Defaults to 0.</p>
</li>
<li>
<p><strong><code>RCJ_SIM_TEAM_YELLOW_ID</code></strong>: The ID of the yellow team used for internal identification.
    Defaults to "The Yellows".</p>
</li>
<li><strong><code>RCJ_SIM_TEAM_BLUE_ID</code></strong>: The ID of the yellow team used for internal identification.
    Defaults to "The Blues".</li>
<li><strong><code>RCJ_SIM_MATCH_ID</code></strong>: The ID of the match used for internal identification.
    Defaults to 1.</li>
<li><strong><code>RCJ_SIM_HALF_ID</code></strong>: The ID of the half time used for internal identification.
    Defaults to 1.</li>
</ul>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../communication_between_robots/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Inter-robot communication" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Inter-robot communication
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>